"use strict";function rcube_elastic_ui(){function a(){var a,b,c=[];$.ui&&$.widget("ui.dialog",$.ui.dialog,{open:function(){return $(this.element).is(".iframe")&&(this.options.width=Math.max(576,this.options.width)),this._super(),L(this),this},close:function(){return this._super(),$(".select-menu:visible").remove(),this}}),Wa.menu.on("click",function(){return I(!0),!1}),Wa.back_sidebar.on("click",function(){return F(),!1}),Wa.back_list.on("click",function(){return G(),!1}),Wa.back_content.on("click",function(){return E(!0),!1}),$(".searchbar").each(function(){M(this)}),!Qa||rcmail.env.extwin||parent.$(".ui-dialog:visible").length?Qa||(a=Va.content.find(".boxtitle").first().detach().text(),a||(a=$("h1.voice").first().text()),a&&Va.content.find(".header > .header-title").text(a)):(a=$("h1.voice").first().text())&&parent.$("#layout-content > .header > .header-title:not(.constant)").text(a),Qa||!Va.content.length||Va.content.is(".no-navbar")||Va.content.children(".frame-content").length||(Ra.frame_nav=$('<div class="footer menu toolbar content-frame-navigation hide-nav-buttons">').append($('<a class="button prev">').append($('<span class="inner"></span>').text(rcmail.gettext("previous")))).append($('<span class="buttons">')).append($('<a class="button next">').append($('<span class="inner"></span>').text(rcmail.gettext("next")))).appendTo(Va.content)),$("a[data-content-button]").each(function(){c.push(d($(this)))}),$(".formbuttons").filter(function(){return!$(this).parent(".searchoptions").length}).find("button").each(function(){var a=$(this);if(Qa||a.parents("#layout-content").length)return a.is(".cancel")?void a.addClass("hidden"):void c.push(d(a))}),(Qa?parent.UI:La).register_content_buttons(c),(b=rcmail.gui_objects.messageform)&&(b=$('form[name="'+b+'"]'),$("#_cc, #_bcc, #_replyto, #_followupto",$(".compose-headers")).each(function(){$(this).on("change",function(){$("#compose"+$(this).attr("id"))[this.value?"removeClass":"addClass"]("hidden")})}),$("#compose-options").find("textarea,input,select").each(function(){var a=$("<input>").attr({type:"hidden",name:$(this).attr("name")}).appendTo(b);$(this).attr("tabindex",2).on("change",function(){a.val("checkbox"!=this.type||this.checked?$(this).val():"")}).change()})),$("[data-recipient-input]").each(function(){ma(this)}),$(".image-upload").each(function(){qa(this)}),$("textarea[data-html-editor]").each(function(){va(this)}),$("#dragmessage-menu,#dragcontact-menu").each(function(){rcmail.gui_object("dragmenu",this.id)}),$("#taskmenu > a").each(function(){if(/button-([a-z]+)/.test(this.className)){var a,b=RegExp.$1,c=e(this.id);c&&(a=c.data)&&(a.sel&&(a.sel=a.sel.replace("button-selected","selected")+" "+b),a.act&&(a.act+=" "+b),rcmail.buttons[c.command][c.index]=a,rcmail.init_button(c.command,a)),$(this).addClass(b),$(".button-inner",this).addClass("inner")}$(this).on("mouseover",function(){rcube_webmail.long_subject_title(this,0,$("span.inner",this))})}),$(".listbutton").each(function(){var a=e(this.id);$(this).addClass("button").removeClass("listbutton"),a.data.sel&&(a.data.sel=a.data.sel.replace("listbutton","button")),a.data.act&&(a.data.act=a.data.act.replace("listbutton","button")),rcmail.buttons[a.command][a.index]=a.data,rcmail.init_button(a.command,a.data)}),$("[data-hidden]").each(function(){for(var a,b=$(this).data("hidden"),c=$(this).parent("li"),d=/(large|big|small|phone|lbs)/g;a=d.exec(b);)$(c.length?c:this).addClass("hidden-"+a[1])}),$("[data-list]").each(function(){$("input[type=checkbox]",this).each(function(){sa(this)})}),Qa&&$(".formcontent").each(function(){$(this).next(".formbuttons").length&&$(this).parent().addClass("formcontainer")}),$("#attachment-list + a.zipdownload").appendTo(".header-links"),(Pa=$("html").is(".ipad,.iphone"))&&$(".iframe-wrapper, .scroller").addClass("ios-scroll"),$("html").filter(".ipad,.iphone,.webkit.mobile,.webkit.tablet").addClass("webkit-scroller").length&&$(Va.menu).addClass("webkit-scroller"),$(".treelist").each(function(){var a=this,b=function(){$(a)[$(".treetoggle",a).length>0?"removeClass":"addClass"]("notree")};window.MutationObserver&&new MutationObserver(b).observe(a,{childList:!0,subtree:!0}),b(),$("li.mailbox > a").on("mouseover",function(){rcube_webmail.long_subject_title_ex(this)})})}function b(a){if(Ra.frame_nav&&a&&a.length){var b=Ra.frame_nav.children(".buttons");Ta=[],$.each(a,function(){this.data("target")&&Ta.push(this.data("target"))}),b.html("").append(a)}}function c(a,b,c){var d=e(a);d&&rcmail.register_button(d.command,b,d.data.type,c,d.data.sel)}function d(a,b,d,f){var g,h=!0,i=$("<a>"),j=a.attr("id")||(new Date).getTime(),k=j+"-clone",l=a[0].className+(d?" "+d:"");return b?(g=a.data("popup"))&&(i.data({popup:g,"toggle-button":a.data("toggle-button")}),O(i[0]),h=!1,rcmail.register_menu_button(i[0],g)):(l=l.replace("btn-primary","primary").replace(/(btn[a-z-]*|button|disabled)/g,"").trim(),l+=" button"+(f?"":" disabled")),i.attr({id:k,href:"#",class:l}).append($('<span class="inner">').text(a.text())),h&&i.on("click",function(b){a.click()}),Qa&&!b?(i.data("target",a),Ua.push($.extend({button_id:k},e(a[0].id)))):c(j,k,l.replace(" disabled","")),i}function e(a){var b,c,d;for(d in rcmail.buttons)for(b=0;b<rcmail.buttons[d].length;b++)if(c=rcmail.buttons[d][b],c.id==a)return{command:d,index:b,data:c}}function f(){if(h(),Ra.last_selected=$("#layout > div.selected")[0],!Ra.last_selected&&Va.content.length&&$.each(["sidebar","list","content"],function(){if(Va[this].length)return Ra.last_selected=Va[this][0],Va[this].addClass("selected"),!1}),$(window).on("resize",function(){clearTimeout(Ra.resize_timeout),Ra.resize_timeout=setTimeout(function(){t()},25)}),Ra.open_window=rcmail.open_window,rcmail.open_window=Da,rcmail.addEventListener("message",J).addEventListener("menu-open",Q).addEventListener("menu-close",Q).addEventListener("editor-init",m).addEventListener("autocomplete_create",p).addEventListener("googiespell_create",p).addEventListener("setquota",la).addEventListener("enable-command",q).addEventListener("destroy-entity-selector",function(a){S(a.name)}).addEventListener("clonerow",ta).addEventListener("init",g),(Va.list.length||Va.content.length)&&Fa()){var a=[];$("[data-fab]").each(function(){var b=$(this),c=b.data("fab-task")||"*",e=b.data("fab-action")||"*";"*"!=c&&c!=rcmail.env.task||"*"!=e&&e!=rcmail.env.action&&("none"!=e||rcmail.env.action)||a.push(d(b,!1,!1,!0))}),a.length&&$('<div class="floating-action-buttons">').append(a).appendTo(Va.list.length?Va.list:Va.content)}Va.sidebar.length&&Ca(Va.sidebar),Va.list.length&&Ca(Va.list)}function g(){$("[data-list]").filter("ul,table").each(function(){var a=$(this),b=a.data("list");if(rcmail[b]&&rcmail[b].multiselect){var c,e,f=a.parents("layout-sidebar,#layout-list,#layout-content").last(),g=f.find(".header"),h=g.find("ul");if(h.length?(e=h.find("a.select").data("toggle-button"))&&(e=$("#"+e)):h=g,rcmail[b].enable_checkbox_selection(),!0===Ha("list-selection")&&a.addClass("withselection"),!e)if(e=$("<a>").attr({class:"button selection disabled",role:"button",title:rcmail.gettext("select")}).on("click",function(){UI.toggle_list_selection(this,a.attr("id"))}).append($('<span class="inner">').text(rcmail.gettext("select"))),h.is(".menu")){if(e.prependTo(h).wrap('<li role="menuitem">'),Va.content){var i=d(e,!0,"hidden-big hidden-large");$('<li role="menuitem">').append(i).appendTo("#toolbar-menu"),e=e.add(i)}}else(c=a.data("list-select-replace"))?$(c).replaceWith(e):(e.appendTo(h).addClass("icon"),f.is("#layout-sidebar")||e.addClass("toolbar-button"));rcmail.addEventListener("listupdate",function(a){a.list&&a.list==rcmail[b]&&(a.rowcount?e.addClass("active").removeClass("disabled").attr("tabindex",0):e.removeClass("active").addClass("disabled").attr("tabindex",-1))})}Oa&&rcmail[b]&&("function"==typeof rcmail[b].draggable?rcmail[b].draggable("destroy"):"boolean"==typeof rcmail[b].draggable&&(rcmail[b].draggable=!1),rcmail[b].dblclick_time=0)}),window.MutationObserver&&$("[data-label-msg]").filter("ul,table").each(function(){var a=$('<div class="listing-info hidden">').insertAfter(this),b=$(this),c=function(){var c,d,e=b.data("label-msg"),f=b.is("ul")?b:b.children("tbody");if(!rcmail.env.search_request&&!rcmail.env.qsearch&&e&&!f.children(":visible").length)return c=b.data("label-ext"),d=b.data("create-command"),!c||d&&!rcmail.commands[d]||(e+=" "+c),void a.text(e).removeClass("hidden");a.addClass("hidden")},d=function(){if(rcmail.busy||!b.is(":visible"))return setTimeout(d,250);clearTimeout(Ra.list_timer),Ra.list_timer=setTimeout(c,50)};new MutationObserver(d).observe(b[0],{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]}),d()}),"print"!=rcmail.env.action&&$("#attachment-list > li").each(function(){fa(this)});var a=function(a){"phone"==Ma&&rcmail.display_message(rcmail.gettext(a),"confirmation")};if(rcmail.addEventListener("fileappended",function(b){b.attachment.complete&&(fa(b.item),"text/vcard"==b.attachment.mimetype&&rcmail.commands["attach-vcard"]&&a("vcard_attachments.vcardattached"))}).addEventListener("managesieve.insertrow",function(a){i(a.obj)}).addEventListener("add-recipient",function(){a("recipientsadded")}),rcmail.init_pagejumper(".pagenav > input"),"mail"==rcmail.task){if("compose"==rcmail.env.action&&(rcmail.addEventListener("compose-encrypted",function(a){$("a.mode-html, button.attach").prop("disabled",a.active),$("a.attach, a.responses:not(.edit)")[a.active?"addClass":"removeClass"]("disabled")}),$("#layout-sidebar > .footer:not(.pagenav) > a.button").click(function(){$(this).is(".disabled")&&rcmail.display_message(rcmail.gettext("nocontactselected"),"warning")}),window.MutationObserver)){var b,c=$("#attachment-list"),e=function(){da("attach",c.children().length>0)};b=new MutationObserver(e),b.observe(c[0],{childList:!0}),e()}rcmail.env.extwin||"compose"!=rcmail.env.action&&"show"!=rcmail.env.action||$("a.mail",Va.menu).attr({"aria-disabled":!1,onclick:"return rcmail.command('list','',this,event);"}),"preview"!=rcmail.env.action&&"show"!=rcmail.env.action||($("a").filter('[href^="mailto:"]').each(function(){ha(this)}),W())}else"settings"==rcmail.task&&(rcmail.addEventListener("identity-encryption-show",function(a){i(a.container)}),rcmail.addEventListener("identity-encryption-update",function(a){i(a.container)}));rcmail.set_env({thread_padding:"1.5rem",popup_width_small:1025,popup_width:1200}),rcmail.env.devel_mode&&window.less?less.pageLoadFinished.then(function(){t(),rcmail.env.compose_focus_elem&&$(rcmail.env.compose_focus_elem).focus()}):t();var f,g=rcmail.env.date_format_localized;g&&(f=function(a){$(a).filter(".datepicker").attr("placeholder",g),$(a).parent().find("select").each(function(){ua(this)})},$("input.datepicker").each(function(){f(this)}),rcmail.addEventListener("insert-edit-field",f))}function h(){if("print"!=rcmail.env.action){var a=rcmail.get_cookie("colorMode"),b=window.matchMedia("(prefers-color-scheme: dark)"),c=function(){rcmail.set_cookie("colorMode","",new Date)},d=function(){try{$(this.contentWindow.document).find("html")["dark"==Na?"addClass":"removeClass"]("dark-mode")}catch(a){}},e=function(){"dark"==Na?($("#taskmenu a.theme").removeClass("dark").addClass("light").find("span").text(rcmail.gettext("lightmode")),$("html").addClass("dark-mode")):($("#taskmenu a.theme").removeClass("light").addClass("dark").find("span").text(rcmail.gettext("darkmode")),$("html").removeClass("dark-mode")),w(Ma),$("iframe").each(d)};if(!1===rcmail.env.dark_mode_support)return void("dark"==a&&(c(),$("iframe").each(d)));$("#taskmenu a.theme").on("click",function(){Na=$(this).is(".dark")?"dark":"light",e(),rcmail.set_cookie("colorMode",Na,!1)}),b.addListener(function(a){Na=a.matches?"dark":"light",e(),c()}),a?Na=a:b.matches&&(Na="dark"),e(),$("iframe").on("load",d)}}function i(a){if(a||(a=document),$("input.button,button",a).not(".btn").addClass("btn").not(".btn-primary,.primary,.mainaction").addClass("btn-secondary"),$("input.button.mainaction,button.primary,button.mainaction",a).addClass("btn-primary"),$("button.btn.delete,button.btn.discard",a).addClass("btn-danger"),$.each(["warning","error","information","confirmation"],function(){var b=this;$(".box"+b+":not(.ui.alert)",a).each(function(){K(this,b,!0)})}),a!=document&&1==$(".popup",a).children().length){var b=$(".popup",a).children().first();if(b.is("img"))$(".popup",a).addClass("justified");else if(b.is("label")){var c=b.find("input").detach(),d=b.detach(),e=c.attr("id");e||c.attr("id",e="dialog-input-elastic"),$(".popup",a).addClass("formcontent").append($('<div class="form-group row">').append(d.attr("for",e).addClass("col-sm-4 col-form-label text-break")).append($('<div class="col-sm-8">').append(c))),c.focus()}}var f="input:not(.button,.no-bs,[type=button],[type=radio],[type=checkbox],[type=file]),textarea";$(f,$(".propform",a)).addClass("form-control"),$("[type=checkbox]",$(".propform",a)).addClass("form-check-input"),$("select",a).addClass("form-control custom-select"),a!=document&&$(f,a).addClass("form-control"),$("table.propform",a).each(function(){var a=0,b=0,c=["sm",4,8];$(this).attr("class").match(/cols-([a-z]+)-(\d)-(\d)/)&&(c=[RegExp.$1,RegExp.$2,RegExp.$3]),$(this).find("> tbody > tr, > tr").each(function(){var d,e,f=$(this),g=["form-group","row"],h=f.children("td");2==h.length?(d=h.first(),e=h.last(),$("label",d).addClass("col-form-label"),d.addClass("col-"+c[0]+"-"+c[1]),e.addClass("col-"+c[0]+"-"+c[2]),1!=e.find("[type=checkbox]").length||e.find(".proplist").length?e.find("input:not([type=hidden]),textarea,radio,select").length?b++:(e.addClass("form-control-plaintext"),a++):(g.push("form-check"),e.find("a").length&&g.push("with-link"),b++),e.children(".datepicker")&&2==e.children("input").length&&e.addClass("datetime")):1==h.length&&h.css("width","100%"),f.addClass(g.join(" "))}),a>b&&$(this).addClass("text-only")}),$("td.input-group",a).each(function(){$(this).children().slice(1).addClass("input-group-append")}),$("fieldset.propform:not(.grouped) div.row",a).each(function(){var a=$("input:not([type=hidden]),select,textarea",this).length>0;a&&$(f,this).addClass("form-control"),$(this).children().last().addClass("col-sm-8"+(a?"":" form-control-plaintext")),$(this).children().first().addClass("col-sm-4 col-form-label"),$(this).addClass("form-group")}),$("fieldset.propform.grouped fieldset",a).each(function(){$(".row",this).each(function(){var a,b=$("input,select,textarea",this).length>0,c=$(this).children();b&&$(f,this).addClass("form-control"),c.length<2||(a=c.first(),a.is("select")?a.addClass("input-group-prepend"):a.wrap('<span class="input-group-prepend">').addClass("input-group-text"),b||c.last().addClass("form-control-plaintext"),$(".content",this).addClass("input-group-prepend input-group-append input-group-text"),$("a.deletebutton",this).addClass("input-group-text icon delete").wrap('<span class="input-group-append">'),$(this).addClass("input-group"))})}),$("fieldset.advanced",a).each(function(){var a=$(this).children(".propform").first();a.wrap($("<div>").addClass("collapse")),$(this).children("legend").first().addClass("closed").on("click",function(){a.parent().collapse("toggle"),$(this).toggleClass("closed")})}),$(".propform > .prop.block:not(.row)",a).each(function(){$(this).addClass("form-group row").each(function(){$("label",this).addClass("col-form-label").wrap($('<div class="col-sm-4">')),$("input,select,textarea",this).wrap($('<div class="col-sm-8">')),$(f,this).addClass("form-control")})}),$("td.rowbuttons > a",a).addClass("btn"),$("form.tabbed,div.tabbed",a).each(function(a,b){var c=[],d=$("<ul>").attr({class:"nav nav-tabs",role:"tablist"});$(this).addClass("tab-content").children("fieldset").each(function(b,d){var e,f=d.id||"tab"+a+"-"+b,g=$(d).data("navlink-class");$(d).addClass("tab-pane").attr({id:f,role:"tabpanel"}),e=$("<li>").addClass("nav-item").append($("<a>").addClass("nav-link"+(g?" "+g:"")).attr({role:"tab",href:"#"+f}).text($("legend",d).first().text()).click(function(a){return $(this).tab("show"),P(a),!1})),$("legend",d).first().hide(),c.push(e)}),d.append(c).insertBefore(b),$("a.nav-link",d).first().click()}),$("input[type=file]:not(.custom-file-input)",a).each(function(){var a=rcmail.gettext("choosefile"+(this.multiple?"s":"")),b=$("<label>").attr({class:"custom-file-label","data-browse":rcmail.gettext("browse")}).text(a);$(this).addClass("custom-file-input").wrap('<div class="custom-file">'),$(this).on("change",function(){var b=a;this.files.length&&(b=this.files[0].name,this.files.length>1&&(b+=", ...")),$(this).next().text(b)}).parent().append(b)}),$("table:not(.table,.compact-table,.propform,.listing,.ui-datepicker-calendar)",a).filter(function(){return!$(this).parent().is(".propform")&&!$(this).parents("#message-header,.message-htmlpart,.message-partheaders,.boxinformation,.raw-tables").length}).each(function(){var a=$(this).addClass("table");a.parent().addClass("table-responsive-sm"),a.find("thead").addClass("thead-default")}),$("input.pretty-checkbox, .propform input[type=checkbox], .form-check input[type=checkbox], .popupmenu.form input[type=checkbox], .menu input[type=checkbox]",a).each(function(){sa(this)}),$(a).is(".actionrow")&&$("input[type=checkbox]",a).each(function(){sa(this)}),$(".input-group-combo > select",a).first().on("change",function(){var a=$(this),b=function(){a[a.next().is(":visible")?"removeClass":"addClass"]("alone")};setTimeout(b,50),setTimeout(b,2e3)}).trigger("change"),$("#message-objects",a).children(":not(.ui.alert)").add(".part-notice").each(function(){var a=String($(this).removeClass("notice part-notice").attr("class")).split(/\s/)[0]||"warning";K(this,a),$(this).addClass("box"+a),$("a",this).addClass("btn btn-primary btn-sm")}),$(".error",a).addClass("is-invalid"),"login"==rcmail.env.task&&a==document&&($("#rcmloginsubmit").addClass("btn-lg text-uppercase w-100"),$("#rcmloginoauth").addClass("btn btn-secondary btn-lg w-100"),$("#login-form table tr").each(function(){var a=$("input,select",this),b=$("label",this),c=a.data("icon"),d=$("<i>").attr("class","input-group-text icon "+a.attr("name").replace("_",""));c&&d.addClass(c),$(this).addClass("form-group row"),b.parent().css("display","none"),a.addClass(a.is("select")?"custom-select":"form-control").attr("placeholder",b.text()).before($('<span class="input-group-prepend">').append(d)).parent().addClass("input-group input-group-lg")})),$("select:not([multiple])",a).each(function(){ua(this)})}function j(){$("[data-popup]").each(function(){O(this)}),$(document).on("click",P),rcube_webmail.set_iframe_events({mousedown:P,touchstart:P})}function k(){if(Va.list.length){var a=Ra.last_selected,b=function(a){"string"==typeof a&&a.length||(a=$("h1.voice").text()||$("title").text()||""),Va.content.find(".header > .header-title").text(a)},c=function(c,d,e,f){Fa()&&Ra.frame_nav&&l(d,c),e&&!Va.content.is(":visible")?Ra.last_selected=Va.content[0]:e||Ra.last_selected==a||Ra.content_lock||(Ra.last_selected=a),u(),b(f&&e?f:null),Ra.content_lock=!1},d=function(a){"large"!=Ma&&!Ra.content_lock&&a.force&&G(),Ra.content_lock=!1,a.title&&$(".header > .header-title",Va.list).text(a.title)},e=function(a){var b={};if("addressbook"!=rcmail.env.task&&"mail"!=rcmail.env.task||(b.force=!0),"mail"==rcmail.env.task&&!rcmail.env.action){var c="string"==$.type(a)?a:rcmail.env.mailbox,e=rcmail.env.mailboxes[c];b.title=e?e.name:""}d(b)};Va.content.find("iframe").on("load",function(a){var d,e="",f=!0;$(this).parent(".iframe-wrapper").scrollTop(0);try{d=a.target.contentWindow,e=d.location.href,f=!e.endsWith(rcmail.env.blankpage),$(d).on("unload",b)}catch(a){}c(a,e,f)}),rcmail.addEventListener("afterlist",e).addEventListener("afterlistgroup",e).addEventListener("afterlistsearch",e).addEventListener("show-list",function(a){a.force=!0,d(a)}).addEventListener("show-content",function(a){a.obj&&!$(a.obj).is("iframe")&&($(a.scrollElement||a.obj).scrollTop(0),Fa()&&ra(a.obj)),c(a.event||new Event,"_action="+(a.mode||"edit"),!0,a.title)})}}function l(a,b){if(a.match(/_action=(create|add)/)||a.match(/_nav=hide/))return void $(Ra.frame_nav).addClass("hide-nav-buttons");var c,d,e,f=$("[data-list]",Va.list).data("list");if(!f||!(e=rcmail[f]))return void($(Ra.frame_nav).is(".hide-nav-buttons")&&!$(".buttons",Ra.frame_nav).children().length&&$(Ra.frame_nav).addClass("hidden"));$(Ra.frame_nav).removeClass("hide-nav-buttons hidden"),(d=e.get_single_selection())&&(e.rows&&e.rows[d]&&!e.rows[d].expanded?e.expand_row(b,d):e.get_node&&(c=e.get_node(d))&&c.collapsed&&e.expand(d));var g,h,i=$("#"+rcmail.env.contentframe),j=$("a.button.next",Ra.frame_nav).off("click").addClass("disabled"),k=$("a.button.prev",Ra.frame_nav).off("click").addClass("disabled");((h=e.get_next())||rcmail.env.current_page<rcmail.env.pagecount)&&j.removeClass("disabled").on("click",function(){Ra.content_lock=!0,ra(i),h?e.select(h):(rcmail.env.list_uid="FIRST",rcmail.command("nextpage"))}),((g=e.get_prev())&&("*"!=g||"subscription_list"!=f)||rcmail.env.current_page>1)&&k.removeClass("disabled").on("click",function(){Ra.content_lock=!0,ra(i),g?e.select(g):(rcmail.env.list_uid="LAST",rcmail.command("previouspage"))})}function m(a){var b=[],c=$("#"+a.id).parent().is(".html-editor");if(a.config.plugins+=" autoresize",Ga()&&(a.config.toolbar="undo redo | link image styleselect"),"mail"==rcmail.task&&"compose"==rcmail.env.action){var d=!1,e=$("#compose-content > form"),f=function(a){"Tab"==a.key&&a.shiftKey&&$("#compose-content > form").scrollTop(0)};b.push(function(a){a.on("keypress",f)}),$("#composebody").on("keypress",f),e.on("scroll",function(){var a=$(".tox-editor-container",e),b=a.find(".tox-toolbar-overlord"),c=a.offset(),f=e.offset().top;c&&c.top-f<0?(b.css({position:"fixed",top:f+"px",width:a.width()+"px"}),d=!0):(d&&($("#compose-subject").focus(),d=!1),b.css({position:"relative",top:0,width:"auto"}))}),$(window).resize(function(){e.trigger("scroll")})}c&&(a.config.toolbar="plaintext | "+a.config.toolbar,a.config.setup_callback=function(a){a.ui.registry.addButton("plaintext",{tooltip:rcmail.gettext("plaintoggle"),icon:"close",onAction:function(b){rcmail.command("toggle-editor",{id:a.id,html:!1},"",b.originalEvent)&&$("#"+a.id).parent().removeClass("ishtml")}})}),b.push(function(a){a.on("OpenWindow",function(a){var b=$(".tox-dialog:last")[0],c=function(a){var c=$(b).find(".tox-dialog__body"),d=$(b).find(".tox-dialog__footer"),e=d.find("button");a||(4===e.length?c.closest(".tox-dialog").addClass("tox-search-dialog"):2==e.length&&e.first().insertAfter(e[1])),c.find(".tox-checkbox > input").each(function(){sa(this)}),c.find(".tox-textarea,.tox-textfield").addClass("form-control")};window.MutationObserver&&new MutationObserver(c).observe($(".tox-dialog__body-content",b)[0],{childList:!0}),c()})}),rcmail.addEventListener("editor-load",function(a){$.each(b,function(){this(a.ref.editor)})})}function n(a){window.MutationObserver&&$(a).not("[data-observed]").each(function(){var a,b=!0,c=Qa?parent:window,d=function(d){$.each(d,function(d,e){if("attributes"==e.type){var f="true"==$(e.target).attr("aria-hidden");f!=b&&(f?a&&a.remove():a=$("<div>").attr("class","ui-widget-overlay datepicker").appendTo(c.document.body).click(function(a){$(this).remove(),Qa&&$.datepicker._hideDatepicker()}),b=f)}else e.addedNodes.length&&(c.UI.bootstrap_style(e.target),Qa&&(c.$("select.ui-datepicker-month",e.target).on("change",function(){$.datepicker._selectMonthYear($.datepicker._lastInput,this,"M")}),c.$("select.ui-datepicker-year",e.target).on("change",function(){$.datepicker._selectMonthYear($.datepicker._lastInput,this,"Y")})))})};$(this).attr("data-observed","1"),Qa&&($(this).detach().appendTo(parent.document.body),$('<div id="ui-datepicker-div" class="hidden">').appendTo(document.body)),new MutationObserver(d).observe(this,{childList:!0,subtree:!1,attributes:!0,attributeFilter:["aria-hidden"]})})}function o(a,b){$(a).is(".active")&&Ia("list-selection",$("#"+b).toggleClass("withselection").is(".withselection"))}function p(a){if($("ul",a.obj).addClass("menu listing iconized"),$(a.obj).addClass("popupmenu popover"),i(a.obj),$("input",a.obj).addClass("form-control"),Fa()&&$(a.obj).is(".googie_window")){var b=rcmail.gettext("close"),c="button icon cancel",d=$("<a>").attr("class",c).text(b).click(function(b){b.stopPropagation(),$(".popover-overlay").remove(),$(a.obj).hide()});$('<h3 class="popover-header">').append(d).prependTo(a.obj),$(".popover-overlay").length||$("<div>").attr("class","popover-overlay").appendTo("body").click(function(){$(this).remove()}),$("ul,button",a.obj).click(function(a){$(a.target).is("input")||$(".popover-overlay").remove()})}}function q(a){if(Qa&&$.each(Ua,function(b,c){a.command==c.command&&parent.$("#"+c.button_id)[a.status?"removeClass":"addClass"]("disabled")}),"mail"==rcmail.task)switch(a.command){case"reply-list":if(1==rcmail.env.reply_all_mode){var b=rcmail.gettext(a.status?"replylist":"replyall");$(".toolbar a.reply-all").attr("title",b).find(".inner").text(b)}break;case"compose-encrypted":$(".toolbar a.encrypt").parent().show();break;case"compose-encrypted-signed":$("#encryption-menu-button").show()}}function r(){var a,b=$(window).width();a=b<=480?"phone":b>1200?"large":b>768?"normal":"small",Oa=b<=1024,Ma=a}function s(){return Ma}function t(){var a;r(),u(),v(),(a=Fa())?(rcmail.set_env(Ra.small_screen_config),rcmail.enable_command("extwin",!1)):(rcmail.set_env(Ra.config),rcmail.enable_command("extwin",!0)),$.each(Ta,function(){$(this)[a?"hide":"show"]()}),rcmail.triggerEvent("skin-resize",{mode:Ma})}function u(){if(Qa&&!Va.sidebar.length&&!Va.list.length)return void x();switch(Ma){case"phone":y();break;case"small":z();break;case"normal":A();break;case"large":B()}w(Ma),x(),bw.webkit&&bw.ipad&&bw.agent.match(/OS 9/)&&$(".iframe-wrapper").each(function(){var a=$(this).height();a&&$(this).children("iframe").height(a)})}function v(){var a=Ea(),b=$(document.documentElement);b[0].className.match(/layout-([a-z]+)/)?RegExp.$1!=a.mode&&b.removeClass("layout-"+RegExp.$1).addClass("layout-"+a.mode):b.addClass("layout-"+a.mode),a.touch&&!b.is(".touch")?b.addClass("touch"):!a.touch&&b.is(".touch")&&b.removeClass("touch")}function w(a){var b=rcmail.env.additional_logos;b&&($("#logo").data("src-default")||$("#logo").data("src-default",$("#logo").attr("src")),"phone"==a&&"dark"==Na&&b["small-dark"]?$("#logo").attr("src",b["small-dark"]):"phone"==a&&b.small?$("#logo").attr("src",b.small):"dark"==Na&&b.dark?$("#logo").attr("src",b.dark):$("#logo").attr("src",$("#logo").data("src-default")))}function x(){$("#layout > div > .header").each(function(){var a,b=0,c=0,d=0,e={left:0,right:0};$(this).children(":visible:not(.position-absolute)").each(function(){if(!a&&$(this).is(".header-title"))return void(a=$(this));e[a?"right":"left"]+=this.offsetWidth}),d+e.right>=e.left?(b=0,c=e.right+d-e.left):(c=0,b=e.left-(d+e.right)),$(a).css({"margin-right":b+"px","margin-left":c+"px","padding-right":d+"px"})})}function y(){C(),I(!1)}function z(){C(),I(!0)}function A(){var a;Va.list.length&&(a=Va.list.is(Ra.last_selected)||!Va.sidebar.is(Ra.last_selected)&&!Va.sidebar.is(".layout-sticky"),Va.list[a?"removeClass":"addClass"]("hidden")),Va.sidebar.length&&(a=!Va.list.length||Va.sidebar.is(Ra.last_selected)||Va.sidebar.is(".layout-sticky"),Va.sidebar[a?"removeClass":"addClass"]("hidden")),Va.content.removeClass("hidden"),I(!0),D(),Va.list.length&&$(".header > ul.menu",Va.list).addClass("popupmenu")}function B(){$.each(Va,function(a,b){b.removeClass("hidden")}),D(),Va.list&&$(".header > ul.menu.popupmenu",Va.list).removeClass("popupmenu")}function C(){var a,b=!1;Va.content.length&&(a=b=Va.content.is(Ra.last_selected),Va.content[a?"removeClass":"addClass"]("hidden"),$(".header > ul.menu",Va.content).addClass("popupmenu")),Va.list.length&&(a=!b&&Va.list.is(Ra.last_selected),Va.list[a?"removeClass":"addClass"]("hidden"),$(".header > ul.menu",Va.list).addClass("popupmenu")),Va.sidebar.length&&(a=!b&&(Va.sidebar.is(Ra.last_selected)||!Va.list.length),Va.sidebar[a?"removeClass":"addClass"]("hidden")),b&&Wa.back_list.show()}function D(){Wa.back_list.filter(function(){return 0==$(this).parents("#layout-sidebar").length}).hide(),$("ul.menu.popupmenu").removeClass("popupmenu")}function E(a){Va.list.addClass("hidden"),Va.sidebar.addClass("hidden"),Va.content.removeClass("hidden"),a&&Va.sidebar.removeClass("layout-sticky"),x(),Ra.last_selected=Va.content[0]}function F(a){Va.list.addClass("hidden"),Va.sidebar.removeClass("hidden"),a&&Va.sidebar.addClass("layout-sticky"),"small"!=Ma&&"phone"!=Ma||Va.content.addClass("hidden"),x(),Ra.last_selected=Va.sidebar[0]}function G(a){Va.list.length||Va.sidebar.length?(Va.sidebar.addClass("hidden").removeClass("layout-sticky"),Va.list.removeClass("hidden"),"small"!=Ma&&"phone"!=Ma||H(),a&&Va.list.children(".scroller").scrollTop(0),Ra.last_selected=Va.list[0]):history.back(),x()}function H(){Ra.last_selected=Va.list[0]||Va.sidebar[0],u(),rcmail.show_contentframe(!1),$("[data-list]",Va.list).each(function(){var a=$(this).data("list");rcmail[a]&&(rcmail[a].clear_selection?rcmail[a].clear_selection():rcmail[a].select&&rcmail[a].select())})}function I(a){a?("phone"==Ma&&($('<div id="menu-overlay" class="popover-overlay">').on("click",function(){I(!1)}).appendTo("body"),Ra.menu_initialized||(Ra.menu_initialized=!0,$("a",Va.menu).on("click",function(a){"phone"==Ma&&I()})),Va.menu.addClass("popover")),Va.menu.removeClass("hidden")):($("#menu-overlay").remove(),Va.menu.addClass("hidden").removeClass("popover"))}function J(a){if("loading"==a.type&&$(".iframe-loader:visible").length)return void rcmail.hide_message(a.object);K(a.object,a.type,!0),$(a.object).attr("role","alert")}function K(a,b,c){var d,e="ui alert",f=!$(a).is(".noicon"),g={information:"alert-info",notice:"alert-info",confirmation:"alert-success",warning:"alert-warning",error:"alert-danger",loading:"alert-info loading",uploading:"alert-info loading",vcardattachment:"alert-info"};c&&f&&!$(a).is(".aligned-buttons")&&$(a).html($("<span>").html($(a).html())),b=b.split(" ")[0],(d=g[b])&&(e+=" "+d,f&&$("<i>").attr("class","icon").prependTo(a)),$(a).addClass(e)}function L(a){var b=$(a.uiDialog),c=b.width(),d=b.height(),e=$(window).width(),f=$(window).height();e<=480?b.css({width:"100%",height:"100%"}):(d>f&&b.css("height","100%"),c>e&&b.css("width","100%")),$(document).click(),ra($("div.popup > iframe",b)),i(a.uiDialog)}function M(a){var b=$(),c=$("a.button.options",a),d=$("input:not([type=hidden])",a),e=d.attr("placeholder"),f=($("form",a),function(){return!!d.val()||(!("mail"!=rcmail.task||!$("#s_interval").val())||(!(!rcmail.gui_objects.search_filter||"ALL"==$(rcmail.gui_objects.search_filter).val())||(!(!rcmail.gui_objects.foldersfilter||"---"==$(rcmail.gui_objects.foldersfilter).val())||void 0)))}),g=function(){$(a).is(".open")&&c.click()},h=function(){$(a)[f()?"addClass":"removeClass"]("active"),b[rcmail.gui_objects.search_filter&&"UNSEEN"==$(rcmail.gui_objects.search_filter).val()?"addClass":"removeClass"]("selected")};d.is("#mailsearchform")&&(b=$("<a>").attr({class:"button unread",href:"#",role:"button",title:rcmail.gettext("showunread")}).on("click",function(a){$(rcmail.gui_objects.search_filter).val($(a.target).is(".selected")?"ALL":"UNSEEN"),rcmail.command("search")}).insertBefore(c)),c.on("click",function(b){var d=$(this).data("target"),e=$("#"+d),f=$(a).is(".open");e.length&&(f||(La[d]?La[d](e.get(0),this,b):"function"==typeof window[d]&&window[d](e.get(0),this,b)),e.next()[f?"show":"hide"](),e.toggleClass("hidden"),$(".floating-action-buttons").toggleClass("hidden"),$(a).toggleClass("open"),$("button.search",e).off("click.search").on("click.search",function(){c.click(),h()}))}),d.on("input change",h).on("focus blur",function(a){d.attr("placeholder","blur"==a.type?e:"")}),$("a.reset",a).on("click",function(b){d.val("").change().trigger("keyup.treelist",{keyCode:27}),$(a).is(".open")&&c.click(),rcmail.gui_objects.search_filter&&$(rcmail.gui_objects.search_filter).val("ALL"),rcmail.gui_objects.foldersfilter&&($(rcmail.gui_objects.foldersfilter).val("---").change(),rcmail.folder_filter("---")),h()}),rcmail.addEventListener("init",h).addEventListener("responsebeforesearch",h).addEventListener("beforelist",g).addEventListener("afterlist",h).addEventListener("beforesearch",g)}function N(){if(!Ra.got_smart_toolbar){Ra.got_smart_toolbar=!0;var a,b=[],c=[],e=Ea(),f=function(a,b,c){var e=$('<li role="menuitem">');a=c?d($(a),!0,"hidden-big hidden-large"):$(a).detach(),a.contents().filter(function(){3==this.nodeType&&0==this.nodeValue.trim().length&&$(this).remove()}),a.is(".spacer")?e.addClass("spacer"):e.append(a),b.push(e)};if(Va.content.find(".header > .menu").each(function(){var a=$(this);a.children().each(function(){f(this,b)}),a.remove()}),Va.list.find(".header > .menu").each(function(){var d=$(this);a=d.next(),d.children().each(function(){"large"!=e.mode&&$(this).data("popup-pos","right"),f(this,b,!0),f(this,c)}),d.remove()}),$('ul[data-menu="toolbar-small"] > li > a').each(function(){var a=$(this).clone();a.attr("id",this.id+"_clone"),b.push($('<li role="menuitem">').addClass("hidden-big").append(a))}),c.length){var g=Va.list.children(".header"),h={class:"menu toolbar popupmenu listing iconized",id:"toolbar-list-menu"},i=$('<a class="button icon toolbar-list-button" href="#list-menu">').attr({"data-popup":"toolbar-list-menu"}),j=$("<ul>").attr(h).data("popup-parent",g).append(c);a.length?j.insertBefore(a):g.append(j),g.append(i)}if(b.length){var g=Va.content.children(".header"),h={class:"menu toolbar popupmenu listing iconized",id:"toolbar-menu"},i=$('<a class="button icon toolbar-menu-button" href="#menu">').attr({"data-popup":"toolbar-menu"});g.append($("<ul>").attr(h).data("popup-parent",g).append(b)).append(i),Va.list.find("a.toolbar-menu-button").click(function(a){a.stopPropagation(),i.click()})}}}function O(a,b){if(Qa&&Fa())return parent.UI.popup_init(a,b||window);b||(b=window);var c,d=$(a).data("popup"),e=$(b.$("#"+d).get(0)),f=e,g=$(a).attr("title"),h=function(){return b!=window&&(e=f.clone(!0,!0),e.attr("id",d+"-clone").appendTo(document.body).find("li > a").attr("onclick","").off("click").on("click",function(c){return $(this).is(".disabled")||($(a).popover("hide"),b.$("#"+$(this).attr("id")).click()),!1})),e.get(0)};$(a).attr({"aria-haspopup":"true","aria-expanded":"false","aria-owns":d}).popover({content:h,trigger:$(a).data("popup-trigger")||"click",placement:$(a).data("popup-pos")||"bottom",animation:!0,boundary:"window",html:!0}).on("show.bs.popover",function(f){var g=e.data("popup-init");d&&Sa[d]&&(Sa[d].transitioning=!0),g&&La[g]?La[g](e.get(0),a,f):g&&b[g]&&b[g](e.get(0),a,f),c=$("div.popover:visible").length+1,e.removeClass("hidden").attr("aria-hidden",!1).find('[aria-haspopup="true"]').data("level",c+1).off("click.popup").on("click.popup",function(a){a.stopPropagation()}),Fa()||e.css("max-height",Math.min(539,$(window).height()-30))}).on("shown.bs.popover",function(b){var e=Fa(),f=$("#"+$(a).attr("aria-describedby"));if(c=$(a).data("level")||1,e){var g=c>1?"back":"close",h=rcmail.gettext(g),i="button icon "+("back"==g?"back":"cancel");$(".popover-header",f).empty().append($("<a>").attr("class",i).text(h).on("click",function(b){$(a).popover("hide"),c>1&&b.stopPropagation()}).on("mousedown",function(a){a.stopPropagation()}))}$.each(Sa,function(a,b){$(b.target).data("level")==c&&a!=d&&R(a)}),"key"==$(a).data("event")&&(f.off("keydown.popup").on("keydown.popup","a.active",function(b){var c,d,e="next";switch(b.which){case 27:case 9:return $(a).popover("toggle").focus(),!1;case 38:case 63232:e="previous";case 40:case 63233:for(c=b.target.parentNode;c=c[e+"Sibling"];)if(d=$(c).children(".active")[0]){d.focus();break}return!1}}),f.find("a.active").first().focus()),d&&Sa[d]&&(Sa[d].transitioning=!1),e&&!$(".popover-overlay").length&&$("<div>").attr("class","popover-overlay").appendTo("body").click(function(){$(this).remove()}),$(".popover-body",f).addClass("webkit-scroller")}).on("hide.bs.popover",function(){1==c&&$(".popover-overlay").remove(),d&&Sa[d]&&e.is(":visible")&&(Sa[d].transitioning=!0),setTimeout(function(){/-clone$/.test(e.attr("id"))?e.remove():e.attr("aria-hidden",!0).addClass("hidden").appendTo(e.data("popup-parent")||document.body),$(".popover-body:empty").each(function(){$(this).parent().remove()}),d&&Sa[d]&&delete Sa[d]},200)}).on("click",function(){$(this).data("event","mouse")}).on("keydown",function(a){if(a.originalEvent)switch(a.originalEvent.which){case 13:case 32:a.preventDefault(),$(this).data("event","key").popover("toggle");break;case 27:$(this).popover("hide")}}),g&&$(a).attr("title",g),!Fa()&&e.is(".toolbar")||e.attr("aria-hidden","true"),e.data("button",a),e.data("editable")&&e.on("click mousedown",function(a){a.stopPropagation()})}function P(a){Ka&&Ka>(new Date).getTime()-250||$(".popover.show").each(function(){var b=$(".popover-body",this),c=b.children().first().data("button");c&&a.target!=c&&!$(c).find(a.target).length&&"string"!=typeof c&&$(c).popover("hide"),c||$(this).remove()})}function Q(a){if(a&&a.name&&(!a.props||!1!==a.props.skinable)){if(Qa&&Fa())return a.win||(a.win=window),parent.UI.menu_toggle(a);if("messagelistmenu"==a.name)U(a);else if("menu-open"==a.event){var b,c,d=$("ul",a.obj).first(),e=a.props&&a.props.link?a.props.link:a.originalEvent.target;if(!d.length)return;$(e).is("span")&&(e=$(e).parents("a,li")[0]),a.name.match(/^drag/)&&(c=rcube_event.get_mouse_pos(a.originalEvent),e=$("<a>").css({position:"absolute",left:c.x,top:c.y,height:"1px",width:"1px",visibility:"hidden"}).appendTo(document.body).get(0)),c=$(e).data("popup-pos")||"right","folder-selector"==a.name?d.addClass("listing folderlist"):"addressbook-selector"==a.name||"contactgroup-selector"==a.name?d.addClass("listing contactlist"):d.hasClass("menu")&&d.addClass("listing"),"pagejump-selector"==a.name&&(d.addClass("simplelist"),a.obj.addClass("simplelist"),c="top"),Sa[a.name]&&R(a.name,a.originalEvent),b=function(){if(Sa[a.name]&&Sa[a.name].transitioning)return setTimeout(b,50);$(e).data("popup")||($(e).data({event:rcube_event.is_keyboard(a.originalEvent)?"key":"mouse",popup:a.name,"popup-pos":c,"popup-trigger":"manual"}),O(e,a.win)),Sa[a.name]={target:e},setTimeout(function(){$(e).popover("show")},1)},b()}else R(a.name,a.originalEvent);a.originalEvent.stopPropagation()}}function R(a,b){var c=T(a);a.match(/^drag/)?$(c).popover("dispose").remove():($(c).popover("hide"),"forwardmenu"==a&&P(b))}function S(a){$("[aria-owns="+a+"]").popover("dispose").data("popup",null)}function T(a){var b;return Sa[a]?b=Sa[a].target:(b=$("#"+a).data("button"))||(a.match(/(?!-)menu$/)&&(a=a.substr(0,a.length-4)),b=$("#"+a+"-menu").data("button")),b}function U(a){var b=$("#listoptions-menu"),c=(b.width(),b.clone(!0));$('select[name="sort_col"]',c).val(rcmail.env.sort_col||""),$('select[name="sort_ord"]',c).val(rcmail.env.sort_order||"ASC"),$('select[name="mode"]',c).val(rcmail.env.threading?"threads":"list"),$("select",c).each(function(){this.id=this.id+"-clone"}),$("label",c).each(function(){$(this).attr("for",$(this).attr("for")+"-clone")});var d=function(a){rcube_event.is_keyboard(a.originalEvent)&&$("#listmenulink").focus();var b=$('select[name="sort_col"]',c).val(),d=$('select[name="sort_ord"]',c).val(),e=$('select[name="mode"]',c).val();return rcmail.set_list_options([],b,d,"threads"==e?1:0),!0};c=rcmail.simple_dialog(c,"listoptionstitle",d,{closeOnEscape:!0,minWidth:400})}function V(a){var b,c,d=!1,e=$("<iframe>").attr({id:"aboutframe",src:rcmail.url("settings/about",{_framed:1})}),f=$("#supportlink");f.length&&(b=f.attr("href"))&&(d=f.text(),c=function(a){b.indexOf("mailto:")<0?window.open(b):location.href=b}),rcmail.simple_dialog(e,$(a).text(),c,{button:d,button_class:"help",cancel_button:"close",height:400})}function W(a){var b="mail.show.envelope",c=void 0===Ha(b)||Ha(b),d=a?!c:c,e=d?"summary":"details",f=$("div.header-content");$("div.header-links").find("a.headers-details,a.headers-summary").removeClass().addClass("headers-"+e).text(rcmail.gettext(e)),f[d?"addClass":"removeClass"]("details-view"),a&&Ia(b,d)}function X(){var a={_uid:rcmail.env.uid,_mbox:rcmail.env.mailbox,_framed:1},b=$("<iframe>").attr({id:"headersframe",src:rcmail.url("headers",a)});rcmail.simple_dialog(b,"arialabelmessageheaders",null,{cancel_button:"close",height:400})}function Y(){var a=$("#properties-menu").clone();rcmail.simple_dialog(a,"properties",null,{cancel_button:"close",height:400})}function Z(){if(rcmail.commands["import-messages"]){var a=$("#uploadform"),b=a.clone(!0),c=function(a){return rcmail.command("import-messages",$(b.find("form")[0]))};rcmail.simple_dialog(b,"importmessages",c,{button:"import",closeOnEscape:!0,minWidth:400})}}function _(a){var b,c="*",d=$('input[name="s_mods[]"]',a),e=$("#s_scope",a),f=$("#s_interval",a),g=rcmail.env.mailbox,h=rcmail.env.search_mods,i=rcmail.env.search_scope||"base";if($(a).data("initialized")||($(a).data("initialized",!0),d.length&&(d.on("change",function(){aa(a,this)}),rcmail.addEventListener("beforesearch",function(){rcmail.env.search_scope=e.val(),rcmail.env.search_interval=f.val()})),$(a).find(".proplist > li > a.dropdown").on("click",function(){var a=$(this).next();a[a.is(".d-none")?"removeClass":"addClass"]("d-none")})),e.val(i),h)if("mail"==rcmail.env.task&&(h=h[g]||h["*"],c="text"),h[c])d.map(function(){this.checked=!0,this.disabled=this.value!=c});else{d.prop("disabled",!1).prop("checked",!1);for(b in h)d.filter('[value="'+b+'"]').prop("checked",!0)}ba(a)}function aa(a,b){var c,d,e={},f=$('input[name="s_mods[]"]',a),g=rcmail.env.task,h=rcmail.env.search_mods||{},i=rcmail.env.mailbox;"mail"==g?(h[i]||(h[i]=rcube_clone_object(h["*"])),d=h[i],c="text",e={sender:["from","replyto","followupto"],recipient:["to","cc","bcc"]}):(d=h,c="*"),b.checked?d[b.value]=1:delete d[b.value],b.value==c?f.not(b).each(function(){this.checked=!0,b.checked?(this.disabled=!0,delete d[this.value]):(this.disabled=!1,this.value in e||(d[this.value]=1))}):b.value in e?(delete d[b.value],f.filter(function(){return-1!=$.inArray(this.value,e[b.value])}).each(function(){b.checked?(this.checked=!0,d[this.value]=1):(this.checked=!1,delete d[this.value])})):e.sender&&ba(a),rcmail.set_searchmods(d)}function ba(a){$(a).find(".proplist > li.with-sublist").each(function(){$(this).find(":not(.proplist) input")[0].checked=$(this).children(".proplist").find("input:checked").length>0})}function ca(a){var b,c,d,e=[],f=rcmail.spellcheck_lang(),g=$("ul",a);if(!g.length){g=$('<ul class="selectable listing iconized" role="menu">');for(b in rcmail.env.spell_langs)d=$('<li role="menuitem">'),c=$('<a href="#'+b+'" tabindex="0"></a>').text(rcmail.env.spell_langs[b]).addClass("active").data("lang",b).on("click keypress",function(a){if("keypress"!=a.type||13==rcube_event.get_keycode(a))return rcmail.spellcheck_lang_set($(this).data("lang")),rcmail.hide_menu("spell-menu",a),!1}),c.appendTo(d),e.push(d);g.append(e).appendTo(a)}$("li",g).each(function(){var a=$("a",this);a.data("lang")==f?a.addClass("selected").attr("aria-selected","true"):a.hasClass("selected")&&a.removeClass("selected").removeAttr("aria-selected")})}function da(a,b){var c=$("#composestatusbar"),d=c.find("a.button.icon."+a);b?d.length||$("<a>").attr("class","button icon "+a).on("click",function(){F()}).appendTo(c):d.remove()}function ea(a,b,c){var d=$(b).parent().attr("id").replace(/^attach/,"");return $.each(["open","download","rename"],function(){var b=this;$("#attachmenu"+b,a).off("click").attr("onclick","").click(function(a){return rcmail.command(b+"-attachment",d,this,a.originalEvent)})}),rcmail.command("menu-open",{menu:"attachmentmenu",id:d},a,c)}function fa(a){if(a=$(a),!a.is(".no-menu")&&!a.children(".dropdown").length){var b=rcmail.gettext("options"),c=a.find("a.filename"),d=$("<a>").attr({href:"#",tabindex:c.attr("tabindex")||0,title:b,class:"button icon dropdown skip-content"}).on("click",function(a){return ea($("#attachmentmenu"),d,a)}).append($("<span>").attr("class","inner").text(b));c.length?d.insertAfter(c):d.appendTo(a)}}function ga(a,b,c,d){var e=$(b).attr("href").replace(/^mailto:/,"");return e.indexOf("@")<0||(a.find("a").off("click").removeClass("active"),rcmail.env.has_writeable_addressbook&&$(".addressbook",a).addClass("active").on("click",function(a){var c=e,d=$(b).filter(".rcmContactAddress").text();return c=c.split("?")[0].split(",")[0].replace(/(^<|>$)/g,""),d&&(d=d.replace("<"+c+">",""),c='"'+d.trim()+'" <'+c+">"),rcmail.command("add-contact",c,this,a.originalEvent)}),$(".compose",a).addClass("active").on("click",function(a){return d?(b.onclick=d,$(b).trigger("click",[!0]),b.onclick=null):rcmail.command("compose",e,this,a.originalEvent),!1}),rcmail.command("menu-open",{menu:"mailto-menu",link:b},b,c.originalEvent))}function ha(a){var b=a.onclick;a.onclick=null,$(a).on("click",function(c,d){return d||ga($("#mailto-menu"),a,c,b)})}function ia(a,b,c){$("li > a",a).each(function(){var a=$(this),b="#compose_"+a.data("target");a[$(b).is(":visible")?"removeClass":"addClass"]("active").off().on("click",function(){$(b).removeClass("hidden").find(".recipient-input input").focus(),a.removeClass("active"),rcmail.set_menu_buttons()})})}function ja(a){$("#"+a).val("").change().closest(".form-group").nextAll(":not(.hidden)").first().find("input").focus(),$("a[data-target="+a.replace(/^_/,"")+"]").addClass("active"),rcmail.set_menu_buttons()}function ka(a,b){b||(b={});var c=b.title||"insertcontact",d=$("#recipient-dialog"),e=d.parent(),f=function(){d.is(":visible")&&rcmail.env.recipient_dialog.dialog("close")},g=function(){if(b.action)return b.action(),void f();rcmail.command("add-recipient")};rcmail.env.recipient_selector_initialized||(rcmail.addEventListener("add-recipient",f),rcmail.env.recipient_selector_initialized=!0),a&&(rcmail.env.focused_field="#_"+a),rcmail.contact_list.clear_selection(),rcmail.contact_list.multiselect=!("multiselect"in b)||b.multiselect,rcmail.env.recipient_dialog=rcmail.simple_dialog(d,c,g,{button:rcmail.gettext(b.button||"insert"),button_class:b.button_class||"insert recipient",height:600,classes:{"ui-dialog-content":"p-0"},open:function(){$("#directorylist a").first().focus()},close:function(){d.appendTo(e),$(this).remove(),$(b.focus||rcmail.env.focused_field).focus()}})}function la(a){var b=$("#quotadisplay"),c=b.find(".bar"),d=a.total?a.percent:0;c.length||(c=$('<span class="bar"><span class="value"></span></span>').appendTo(b)),d>0&&d<10&&(d=10),c.find(".value").css("width",d+"%")[d>=90?"addClass":"removeClass"]("warning"),b.attr({"data-original-title":"",title:b.find(".count").attr("title")}),a.table?b.css("cursor","pointer").data("popup-pos","top").off("click").on("click",function(b){rcmail.simple_dialog(a.table,"quota",null,{cancel_button:"close"})}):b.tooltip("dispose").tooltip({trigger:Fa()?"click":"hover"})}function ma(a){var b,c,d="",e=function(){$(a).val(b.text()+c.val())},f=function(a,b,d){var g=$('<li class="recipient">'),h=$('<span class="name">').html(oa(a||b)).on("dblclick",function(a){pa(a,f)}),i=$('<span class="email">'),j=$("<a>").attr({class:"button icon remove"}).click(function(){return g.remove(),e(),c.focus(),!1});a&&(b=" <"+b+">"),i.text((a?b:"")+","),g.attr("title",a?a+b:null).append([h,i,j]),d?d.replaceWith(g):g.insertBefore(c.parent()),e()},g=function(a){var b;return a=(a||c.val()).replace(/[,;\s]+$/,""),b=na(a),$.each(b.recipients,function(){f(this.name,this.email)}),c.val(b.text),e(),b.recipients.length>0},h=function(a,c,d){var e,f,h=this.value;!1!==d&&("paste"==a.type?(f=(a.originalEvent.clipboardData||window.clipboardData).getData("text")||"",h=h.substring(0,this.selectionStart)+f+h.substring(this.selectionEnd),a.preventDefault()):c&&(e=b.find("li.recipient").last(),e.length&&this.value.indexOf(e.text().replace(/[ ,]+$/,""))>-1&&e.remove()),g(h))},i=function(a){return 8!=a.keyCode||c.val().length?!((" "==a.key||","==a.key||";"==a.key||"Enter"==a.key&&!rcmail.ksearch_visible())&&g())&&void 0:(b.children("li.recipient").last().remove(),e(),!1)};c=$("<input>").attr({type:"text",tabindex:$(a).attr("tabindex")}).on("paste change",h).on("keydown",i).on("blur",function(){b.removeClass("focus")}).on("focus mousedown",function(){b.addClass("focus")}),b=$("<ul>").addClass("form-control recipient-input ac-input rounded-left").append($('<li class="input">').append(c)).on("mouseup",function(){d=window.getSelection().toString()}).on("click",function(){d.length||c.focus()}).sortable({appendTo:document.body,items:"> .recipient",connectWith:".recipient-input",receive:function(a,c){var d=b.text();b.find(".recipient").remove(),g(d),c.sender&&c.sender.find("input").change()}}),$(a).css({position:"absolute",opacity:0,left:"-5000px",width:"10px"}).attr("tabindex",-1).after(b).on("focus",function(a){c.focus(),a.preventDefault()}).on("change",function(){$("li.recipient",b).remove(),c.val(this.value).change()}).change(),rcmail.init_address_input_events(c)}function na(a){a=a.replace(/[,;\s]*[\r\n]+/g,",").trim();var b=[],c='(\\S+|("[^"]+"))@\\S+',d=new RegExp("(<"+c+">)"),e=new RegExp("("+c+")"),f=/(?=\S)[^",;]*(?:"[^\\"]*(?:\\[,;\S][^\\"]*)*"[^",;]*)*/g,g=a.match(f);return $.each(g||[],function(){if(this.length&&(d.test(this)||e.test(this))){var c,f=this;for(a=a.replace(f,"");f.length&&0===f.indexOf(RegExp.$1)&&(c=RegExp.$1,b.push({name:"",email:c.replace(/(^<|>$)/g,"").replace(/[^\p{L}]$/giu,"")}),f=f.replace(c,"").trim(),d.test(f)||e.test(f)););c!=RegExp.$1&&RegExp.$1&&(c=RegExp.$1,b.push({name:f.replace(c,"").trim(),email:c.replace(/(^<|>$)/g,"")}))}}),a=a.replace(/[,;]+/,",").replace(/^[,;\s]+/,""),{recipients:b,text:a}}function oa(a){var b,c,d="",e=a.length;for('"'!=a.charAt(0)&&a.indexOf('"')>-1&&(a='"'+a.replace("\\","\\\\").replace('"','\\"')+'"'),b=0;b<e;b++)switch(c=a.charAt(b)){case'"':if(b>0&&b<e-1){d+='"';break}d+='<span class="quotes">'+c+"</span>";break;case"\\":d+='<span class="quotes">'+c+"</span>","\\"==a.charAt(b+1)&&(d+=c,b++);break;case"<":d+="&lt;";break;case">":d+="&gt;";break;default:d+=c}return d}function pa(a,b){var c=$(a.target).parents(".recipient"),d=c.text().replace(/,+$/,""),e=$("<input>").attr({type:"text","data-submit":"true"}).val(d),f=$("<label>").text(rcmail.gettext("recipient")).append(e);rcmail.simple_dialog(f,"recipientedit",function(){var a,f=e.val();if(f){if(f!=d){if(a=na(f),1!=a.recipients.length)return!1;b(a.recipients[0].name,a.recipients[0].email,c)}return!0}})}function qa(a){var b=$("<a>").attr({class:"icon button delete",href:"#"}).click(function(a){return rcmail.command("delete-photo","",this,a),!1}),c=$(a).find("img")[0],d=function(){var b=-1!=(c.currentSrc||c.src).indexOf(rcmail.env.photo_placeholder);$(a)[b?"removeClass":"addClass"]("changed")};$(a).append(b).click(function(){rcmail.upload_input("upload-form")}),d(),$(c).on("load",d)}function ra(a){if(a=$(a),a.length){var b=$('<div class="iframe-loader">').append($('<div class="spinner spinner-border" role="status">').append($('<span class="sr-only">').text(rcmail.gettext("loading"))));a.on("load error loaded",function(){setTimeout(function(){b.remove()},500)}).parent().append(b),Pa&&a.parent().addClass("ios-scroll")}}function sa(a){var b,c;a=$(a),a.is(".custom-control-input")||((c=a.attr("id"))||(c="icochk"+ ++Ra.checkboxes,a.attr("id",c)),a.parent().is("label")?(b=a.parent(),a=a.detach(),b.before(a)):b=$("<label>"),b.attr({for:c,class:"custom-control-label",title:a.attr("title")||""}).on("click",function(a){a.stopPropagation()}),a.addClass("form-check-input custom-control-input").wrap('<div class="custom-control custom-switch">').parent().append(b))}function ta(a){var b,c=$(a.row).find("input[id^=icochk]");c.length&&(b="icochk"+ ++Ra.checkboxes,c.attr("id",b).next("label").attr("for",b))}function ua(a){if(!bw.iphone&&!bw.ipad&&(a=$(a),!a.is(".pretty-select"))){var b="select"+a.attr("id")+a.attr("name"),c=function(){if(a[0].ownerDocument.defaultView.$(".select-menu .listing").data("ident")==b)return!0},d=function(){var b=c();return a.popover("dispose").focus(),!b},e=function(c){var e,f=-1,g=[],h=[],i=a.closest(".ui-dialog")[0],j=(document.documentElement.clientHeight||$(document.body).height())-75,k=$(document.body).width()-20,l=Math.min(a.outerWidth(),k),m=a.val();Fa()||(j*=.5),P(c),$("option",a).each(function(){var a=$(this).text(),b=$('<a href="#">').data("value",this.value).addClass(this.disabled?"disabled":"active"+(this.value==m?" selected":""));a.length?(b.text(a),h.push(this.disabled?"":a.charAt(0).toLowerCase())):(b.html("&nbsp;"),h.push("")),g.push($("<li>").append(b))});var n=$('<ul class="listing selectable iconized">').attr("data-ident",b).data("button",a[0]).append(g).on("click","a.active",function(){var b=$(this).data("value"),c=d();return a.val(b).change(),c}).on("keydown","a.active",function(a){var b,c,g,i,j="next";switch(a.which){case 27:case 9:return d();case 13:case 32:return $(this).click(),!1;case 38:case 63232:j="previous";case 40:case 63233:for(b=a.target.parentNode;b=b[j+"Sibling"];)if(i=$(b).children(".active")[0]){i.focus();break}return!1;default:c=a.originalEvent.key,c&&1==c.length&&(c=c.toLowerCase(),e!=c&&(f=-1),g=h.indexOf(c,f+1),(g>-1||(g=h.indexOf(c))>-1)&&n.find("a").eq(g).focus(),e=c,f=g)}});a.popover("dispose").popover({container:i||document.body,content:n[0],placement:"bottom",trigger:"manual",boundary:"viewport",html:!0,offset:"0,2",sanitize:!1,template:'<div class="popover select-menu" style="min-width: '+l+"px; max-width: "+k+'px"><div class="popover-header"></div><div class="popover-body" style="max-height: '+j+'px"></div></div>'}).on("shown.bs.popover",function(){a.focus(),n.parent().prev().empty().append($('<a class="button icon cancel">').text(rcmail.gettext("close")).on("click",function(a){return a.stopPropagation(),d()}));var b=n.find("a.selected").first();if(b.focus().length){var g=n.parent();f=n.find("a").index(b[0]),e=h[f],bw.mz&&f>5&&g.scrollTop(g.scrollTop()+g.height()/2-20)}else rcube_event.is_keyboard(c)&&n.find("a.active").first().focus();n.on("mousedown",function(a){a.stopPropagation()})}).popover("show")};a.addClass("pretty-select custom-select form-control").on("mousedown keydown",function(b){if(a=$(b.target),!a.prop("disabled"))return 9==b.which?(d(),!0):27==b.which||"mousedown"==b.type&&c()?d():(a.focus(),a.prop("disabled",!0),setTimeout(function(){a.prop("disabled",!1)},0),b.stopPropagation(),"mousedown"==b.type||13==b.which||32==b.which||40==b.which||63233==b.which?(e(b),Ka=(new Date).getTime(),!1):void 0)})}}function va(a){var b,c=!1,d=$(a),e=d.parent(),f=d.is("[readonly],[disabled]"),g=$('<a class="mce-i-html" href="#" tabindex="-1"></a>').attr({title:rcmail.gettext("htmltoggle"),disabled:f}).on("click",function(a){!f&&rcmail.command("toggle-editor",{id:d.attr("id"),html:!0},"",a.originalEvent)&&e.addClass("ishtml")}).on("keydown",function(a){if(9==a.which)return d.focus(),!1}),h=$('<div class="editor-toolbar">').append(g);e.is("td")?(b=$('input[type="checkbox"]',e.parent().next()),c=!0):b=d.next("select.hidden"),wa(a),1==b.length&&(e.addClass("html-editor"),d.after(h).data("control",b).on("keydown",function(a){a.altKey&&121==a.which&&g.focus()}),c&&(b.parents("tr").first().hide(),e.prev().hide(),e.addClass("col-sm-12")))}function wa(a){var b,c,d=function(){if(!a.scrollHeight)return setTimeout(d,250);if(b||(b=parseInt($(a).css("padding-top"))+parseInt($(a).css("padding-bottom"))+2,c=$(a).height()),!(a.scrollHeight-b<=c)){var e,f=0;$(a).parents().each(function(){if(this.scrollTop>0)return e=this,f=this.scrollTop,!1});var g=$(a).outerHeight();$(a).outerHeight(0);var h=Math.max(c,a.scrollHeight);$(a).outerHeight(g),h!==g&&$(a).height(h),f&&(e.scrollTop=f)}};$(a).on("input",d),setTimeout(d,100)}function xa(a){var b=a.id+"_list",c=$('<div class="multi-input"><div class="content"></div><div class="invalid-feedback"></div></div>'),d=a.value?a.value.split("\n"):[""];$("#"+b).length||($.each(d,function(b,d){ya($(".content",c),d,b,a)}),c.attr("id",b),a=$(a),a.attr("disabled")?c.hide():a.prop("disabled",!0),a.data("hidden")&&c.hide(),a.after(c),a.hasClass("is-invalid")&&(c.addClass("is-invalid"),$(".invalid-feedback",c).text(a.data("error-msg"))))}function ya(a,b,c,d,e){var f,g=$('<div class="input-group"><input type="text" class="form-control"><span class="input-group-append"><a class="icon reset input-group-text" href="#"></a></span></div>');return f=g.find("input").attr({value:b,name:d.name+"[]",size:$(d).data("size"),title:d.title,placeholder:d.placeholder}).keydown(function(b){if(13==b.which){var c=ya(a,"",(new Date).getTime(),d,f.parent());$("input",c).focus()}else if((8==b.which||46==b.which)&&""==f.val()){var e=f.parent(),g=a.children();if(g.length>1)return e.prev().length?e.prev().children("input").focus():e.next().children("input").focus(),e.remove(),!1}}),g.find("a.reset").click(function(){var b=$(this.parentNode.parentNode);a.children().length>1?($("input",b.next().length?b.next():b.prev()).focus(),b.remove()):$("input",b).val("").focus()}),g.find("input,a").on("focus",function(){a.addClass("focused")}).on("blur",function(){a.removeClass("focused")}),e?e.after(g):g.appendTo(a),g}function za(a,b){var c=a.id+"_list",d=b.length?b:[""],e=$("#"+c).children(".content");e.empty(),$.each(d,function(b,c){ya(e,c,b,a)})}function Aa(a){$.each(a,function(){var a=$("#"+this[0]).addClass("is-invalid");if("list"==a.data("type"))return a.data("error-msg",this[2]),void $("#"+this[0]+"_list > .invalid-feedback").text(this[2]);a.after($('<span class="invalid-feedback">').text(this[2]))})}function Ba(a){var b,c,d=250,e=$("a",a),f=$(a).next();f.height()?(f.animate({height:"0"},d),e.addClass("expand").removeClass("collapse"),$(a).removeClass("expanded")):(b=$("tr,li",f).filter(function(){return"none"!=this.style.display}),c=$(b[0]).height()||50,f.animate({height:Math.min(5,b.length)*c+1+"px"},d),e.addClass("collapse").removeClass("expand"),$(a).addClass("expanded"))}function Ca(a){var b=a.find(".scroller .listing").first().attr("id"),c=rcmail.env.task+"."+(b||rcmail.env.action+"."+a.attr("id")),d=Ha(c),e=a.is(".sidebar-right"),f=function(b){a.css({width:Math.max(100,b),flex:"none"})};a[e?"prev":"next"]().length&&($('<div class="column-resizer">').addClass(e?"inverted":null).appendTo(a).on("mousedown",function(b){var d,g=$(this),h=a.position().left;g.addClass("active"),document.body.style.userSelect="none",$(document).on("mousemove.resizer",function(b){clearTimeout(d),d=setTimeout(function(){e&&(h=a.position().left);var c=rcube_event.get_mouse_pos(b).x,d=e?a.width()+(h-c):c-h;f(d)},5)}).on("mouseup.resizer",function(){$(document).off(".resizer"),$("iframe").off(".resizer"),document.body.style.userSelect="auto",g.removeClass("active"),Ia(c,a.width())})}),d&&f(d))}function Da(a,b,c,d){var e=function(a){$(a).css({color:$(document.body).css("color"),backgroundColor:$(document.body).css("background-color")})},f="dark"==Na&&/_task=mail/.test(a)&&/_action=viewsource/.test(a);if(!Fa()||!0===d){/_task=mail/.test(a)&&/_action=get/.test(a)&&(b=!0);var g=Ra.open_window.call(rcmail,a,b,c);return f&&$(g).on("load",function(){e(g.document.body)}),g}a=rcmail.add_url(a,"_framed",1),a=rcmail.add_url(a,"_extwin",1);var h,i="",j={cancel_button:"close",width:768,height:768},k=$("<iframe>").attr({id:"windowframe",src:a});return/_action=([a-z_]+)/.test(a)&&(h=rcmail.labels[RegExp.$1])&&(i=h),/_frame=1/.test(a)&&(j.dialogClass="no-titlebar"),f&&k.on("load",function(){e(k[0].contentWindow.document.body)}),rcmail.simple_dialog(k,i,null,j),!0}function Ea(){if(Qa){var a=$(parent.document.documentElement);return{mode:a[0].className.match(/layout-([a-z]+)/)?RegExp.$1:Ma,touch:a.is(".touch")}}return{mode:Ma,touch:Oa}}function Fa(){var a=Ea();return"phone"==a.mode||"small"==a.mode}function Ga(){return Ea().touch}function Ha(a){if(Ja||(Ja=rcmail.local_storage_get_item("prefs.elastic",{})),null==Ja[a]){var b=rcmail.get_cookie(a);null!=b&&(Ja[a]=b,rcmail.local_storage_set_item("prefs.elastic",Ja)&&rcmail.set_cookie(a,b,new Date))}return Ja[a]}function Ia(a,b){Ja[a]=b,rcmail.local_storage_set_item("prefs.elastic",Ja)||rcmail.set_cookie(a,b,!1)}var Ja,Ka,La=this,Ma="normal",Na="light",Oa=!1,Pa=!1,Qa=rcmail.is_framed(),Ra={config:{standard_windows:rcmail.env.standard_windows,message_extwin:rcmail.env.message_extwin,compose_extwin:rcmail.env.compose_extwin,help_open_extwin:rcmail.env.help_open_extwin},checkboxes:0,small_screen_config:{standard_windows:!0,message_extwin:!1,compose_extwin:!1,help_open_extwin:!1}},Sa={},Ta=[],Ua=[],Va={menu:$("#layout-menu"),sidebar:$("#layout-sidebar"),list:$("#layout-list"),content:$("#layout-content")},Wa={menu:$("a.task-menu-button"),back_sidebar:$("a.back-sidebar-button"),back_list:$("a.back-list-button"),back_content:$("a.back-content-button")};this.register_content_buttons=b,this.menu_hide=R,this.menu_toggle=Q,this.menu_destroy=S,this.popup_init=O,this.about_dialog=V,this.headers_dialog=X,this.import_dialog=Z,this.props_dialog=Y,this.headers_show=W,this.spellmenu=ca,this.searchmenu=_,this.headersmenu=ia,this.header_reset=ja,this.compose_status=da,this.attachmentmenu=ea,this.mailtomenu=ga,this.recipient_selector=ka,this.show_list=G,this.show_sidebar=F,this.smart_field_init=xa,this.smart_field_reset=za,this.form_errors=Aa,this.switch_nav_list=Ba,this.searchbar_init=M,this.pretty_checkbox=sa,this.pretty_select=ua,this.datepicker_init=n,this.bootstrap_style=i,this.toggle_list_selection=o,this.get_screen_mode=s,this.is_mobile=Fa,this.is_touch=Ga,r(),f(),i(),N(),k(),j(),a(),t()}if(window.rcmail)rcmail.show_menu=function(a,b,c){var d="object"==typeof a?a.menu:a,e=$("#"+d);return"string"==typeof a&&(a={menu:d}),rcmail.triggerEvent(!1===b?"menu-close":"menu-open",{name:d,obj:e,props:a,originalEvent:c})},rcmail.hide_menu=function(a,b){return rcmail.triggerEvent("menu-close",{name:a,props:{menu:a},originalEvent:b})};else var rcmail=parent.rcmail,rcube_webmail=parent.rcube_webmail,bw={};var UI=new rcube_elastic_ui;if($&&$.datepicker){var __newInst=$.datepicker._newInst;$.extend($.datepicker,{_newInst:function(a,b){var c=__newInst.call(this,a,b);return c.inline||UI.datepicker_init(c.dpDiv),c}})}